<template>
  <ArticleDetailLayout 
    :article="article" 
    :category="'tech'"
    :table-of-contents="tableOfContents"
    :related-articles="relatedArticles"
    @like-toggled="onLikeToggled"
  >
    <template #content>
      <div class="content-section">
        <h2>å‰è¨€</h2>
        <p>JavaScriptçš„å¼‚æ­¥ç¼–ç¨‹æ˜¯ç°ä»£å‰ç«¯å¼€å‘ä¸­ä¸å¯æˆ–ç¼ºçš„æŠ€èƒ½ã€‚ä»å›è°ƒå‡½æ•°åˆ°Promiseï¼Œå†åˆ°async/awaitï¼ŒJavaScriptå¼‚æ­¥ç¼–ç¨‹ç»å†äº†å·¨å¤§çš„å‘å±•ã€‚æœ¬æ–‡å°†å¸¦æ‚¨æ·±å…¥äº†è§£JavaScriptå¼‚æ­¥ç¼–ç¨‹çš„å‘å±•å†ç¨‹å’Œæœ€ä½³å®è·µã€‚</p>
      </div>

      <div class="content-section">
        <h2>å¼‚æ­¥ç¼–ç¨‹çš„å‘å±•å†ç¨‹</h2>
        <p>JavaScriptå¼‚æ­¥ç¼–ç¨‹çš„å‘å±•å¯ä»¥åˆ†ä¸ºå‡ ä¸ªé‡è¦é˜¶æ®µï¼š</p>
        
        <h3>1. å›è°ƒå‡½æ•°æ—¶ä»£</h3>
        <p>æœ€åˆçš„å¼‚æ­¥å¤„ç†æ–¹å¼ï¼Œç®€å•ä½†å®¹æ˜“é™·å…¥å›è°ƒåœ°ç‹±ã€‚</p>
        
        <div class="code-block">
          <div class="code-header">
            <span class="code-title">å›è°ƒå‡½æ•°ç¤ºä¾‹</span>
            <button class="copy-btn">å¤åˆ¶</button>
          </div>
          <pre><code>function fetchData(callback) {
  setTimeout(() => {
    callback(null, 'data from server');
  }, 1000);
}

fetchData((err, data) => {
  if (err) {
    console.error(err);
  } else {
    console.log(data);
  }
});</code></pre>
        </div>

        <h3>2. Promiseçš„å‡ºç°</h3>
        <p>Promiseè§£å†³äº†å›è°ƒåœ°ç‹±é—®é¢˜ï¼Œæä¾›äº†æ›´ä¼˜é›…çš„å¼‚æ­¥å¤„ç†æ–¹å¼ã€‚</p>
        
        <div class="code-block">
          <div class="code-header">
            <span class="code-title">Promiseç¤ºä¾‹</span>
            <button class="copy-btn">å¤åˆ¶</button>
          </div>
          <pre><code>function fetchData() {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      resolve('data from server');
    }, 1000);
  });
}

fetchData()
  .then(data => console.log(data))
  .catch(err => console.error(err));</code></pre>
        </div>
      </div>

      <div class="content-section">
        <h2>async/awaitï¼šç°ä»£å¼‚æ­¥ç¼–ç¨‹</h2>
        <p>ES2017å¼•å…¥çš„async/awaitè¯­æ³•ä½¿å¾—å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ï¼Œå¤§å¤§æé«˜äº†ä»£ç çš„å¯è¯»æ€§ã€‚</p>
        
        <div class="code-block">
          <div class="code-header">
            <span class="code-title">async/awaitç¤ºä¾‹</span>
            <button class="copy-btn">å¤åˆ¶</button>
          </div>
          <pre><code>async function fetchUserData() {
  try {
    const user = await fetch('/api/user');
    const userData = await user.json();
    const posts = await fetch(`/api/posts/${userData.id}`);
    const postsData = await posts.json();
    
    return { user: userData, posts: postsData };
  } catch (error) {
    console.error('Failed to fetch data:', error);
  }
}</code></pre>
        </div>
      </div>

      <div class="content-section">
        <h2>æœ€ä½³å®è·µ</h2>
        <div class="practice-list">
          <div class="practice-item">
            <div class="practice-icon">ğŸ¯</div>
            <div class="practice-content">
              <h4>é”™è¯¯å¤„ç†</h4>
              <p>åœ¨async/awaitä¸­ä½¿ç”¨try-catchï¼Œåœ¨Promiseä¸­ä½¿ç”¨.catch()å¤„ç†é”™è¯¯ã€‚</p>
            </div>
          </div>
          <div class="practice-item">
            <div class="practice-icon">âš¡</div>
            <div class="practice-content">
              <h4>å¹¶å‘å¤„ç†</h4>
              <p>ä½¿ç”¨Promise.all()å¤„ç†å¹¶å‘å¼‚æ­¥æ“ä½œï¼Œæé«˜æ€§èƒ½ã€‚</p>
            </div>
          </div>
          <div class="practice-item">
            <div class="practice-icon">ğŸ”„</div>
            <div class="practice-content">
              <h4>é¿å…é˜»å¡</h4>
              <p>åˆç†ä½¿ç”¨å¼‚æ­¥æ“ä½œï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚</p>
            </div>
          </div>
        </div>
      </div>

      <div class="content-section">
        <h2>æ€»ç»“</h2>
        <p>å¼‚æ­¥ç¼–ç¨‹æ˜¯JavaScriptçš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼ŒæŒæ¡ç°ä»£å¼‚æ­¥ç¼–ç¨‹æŠ€æœ¯å¯¹äºå‰ç«¯å¼€å‘è€…æ¥è¯´è‡³å…³é‡è¦ã€‚ä»å›è°ƒå‡½æ•°åˆ°Promiseï¼Œå†åˆ°async/awaitï¼Œæ¯ä¸€æ¬¡è¿›æ­¥éƒ½è®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ ä¼˜é›…å’Œæ˜“ç»´æŠ¤ã€‚</p>
      </div>
    </template>
  </ArticleDetailLayout>
</template>

<script>
import { reactive } from 'vue'
import ArticleDetailLayout from '../../../components/ArticleDetailLayout.vue'

export default {
  name: 'TechArticle2',
  components: {
    ArticleDetailLayout
  },
  setup() {
    const article = reactive({
      id: 2,
      title: 'JavaScriptå¼‚æ­¥ç¼–ç¨‹å®Œå…¨æŒ‡å—',
      author: 'éœç®æ”¾',
      readCount: 892,
      likes: 35,
      date: '2025å¹´7æœˆ15æ—¥',
      category: 'ç¼–ç¨‹è¯­è¨€',
      tags: ['JavaScript', 'å¼‚æ­¥ç¼–ç¨‹', 'Promise', 'async/await']
    })

    const tableOfContents = [
      { id: 'section1', title: 'å‰è¨€', href: '#section1' },
      { id: 'section2', title: 'å¼‚æ­¥ç¼–ç¨‹çš„å‘å±•å†ç¨‹', href: '#section2' },
      { id: 'section3', title: 'async/awaitï¼šç°ä»£å¼‚æ­¥ç¼–ç¨‹', href: '#section3' },
      { id: 'section4', title: 'æœ€ä½³å®è·µ', href: '#section4' },
      { id: 'section5', title: 'æ€»ç»“', href: '#section5' }
    ]

    const relatedArticles = [
      { id: 1, title: 'Vue 3 ç»„åˆå¼APIè¯¦è§£ä¸å®è·µ', date: '07-16' },
      { id: 3, title: 'TypeScriptè¿›é˜¶ä½¿ç”¨æŠ€å·§', date: '07-14' },
      { id: 5, title: 'ES6+æ–°ç‰¹æ€§è¯¦è§£', date: '07-12' }
    ]

    const onLikeToggled = (newLikes) => {
      console.log('æ–‡ç« ç‚¹èµæ•°æ›´æ–°:', newLikes)
    }

    return {
      article,
      tableOfContents,
      relatedArticles,
      onLikeToggled
    }
  }
}
</script>

<style scoped>
@import '../../../styles/article-content.css';
</style>
